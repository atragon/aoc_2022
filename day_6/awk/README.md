Both part 1 and part 2 can be solved  with the same algorithm, with just one constant change.
Removing the comments and the code that is not needed for solving the actual problems, like the printing functions and their call sites, the program is just 22 lines long.



